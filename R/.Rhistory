baseGroups = c("OSM (default)","World StreetMap", "World Imagery"),
options = layersControlOptions(collapsed = FALSE))%>%
addPolygons(data = final ,
fillColor = ~pal(final$diff_prior),
fillOpacity = 0.7,
weight = 0.2,
smoothFactor = 0.2,
popup = ~popup_sb) %>%
addLegend(pal = pal,
values = final$diff_prior,
position = "bottomright",
title = "YTD Changes in Violent Crime Counts",reverse=TRUE)
#POPUP
comp_ytds$popup<-paste("<b>HPD Beat: </b>", comp_ytds$Beat, "<br>",
"<br>", "<b>Change from Last Year: </b>", comp_ytds$diff_prior,
"<br>", "<b>Change from 2019: </b>", comp_ytds$diff_base,
"<br>", "<b>Offense Count 2019: </b>", comp_ytds$'2019',
"<br>", "<b>Offense Count 2022: </b>", comp_ytds$'2022',
"<br>", "<b>Offense Count 2023: </b>", comp_ytds$'2023',)
#POPUP
comp_ytds$popup<-paste("<b>HPD Beat: </b>", comp_ytds$Beat, "<br>",
"<br>", "<b>Change from Last Year: </b>", comp_ytds$diff_prior,
"<br>", "<b>Change from 2019: </b>", comp_ytds$diff_base,
"<br>", "<b>Offense Count 2019: </b>", comp_ytds$'2019',
"<br>", "<b>Offense Count 2022: </b>", comp_ytds$'2022',
"<br>", "<b>Offense Count 2023: </b>", comp_ytds$'2023')
View(comp_ytds)
View(comp_ytds)
library('tigris')
bas_yr='2019'
pri_yr='2022'
cur_yr='2023'
latest_mon='06'
base_end_dt<-round_date(as.Date(ISOdate( year=bas_yr
,month=latest_mon
,day='28')),'month')-days(1)
pri_end_dt<-round_date(as.Date(ISOdate( year=pri_yr
,month=latest_mon
,day='28')),'month')-days(1)
cur_end_dt<-round_date(as.Date(ISOdate( year=cur_yr
,month=latest_mon
,day='28')),'month')-days(1)
incidents_ytd<-multi_year[ (NIBRSDescription %chin% violent_crimes),]%>%
.[( RMSOccurrenceDate>=glue('{bas_yr}-01-01')
&RMSOccurrenceDate<=base_end_dt)
|( RMSOccurrenceDate>=glue('{pri_yr}-01-01')
&RMSOccurrenceDate<=pri_end_dt)
|( RMSOccurrenceDate>=glue('{cur_yr}-01-01')
&RMSOccurrenceDate<=cur_end_dt),]
#Aggregate
incidents_ytd_agg<-incidents_ytd[,.(OffenseCount=sum(OffenseCount))
,by=list(Beat,year)]
#Transpose Column per year
comp_ytds<-dcast( incidents_ytd_agg
,Beat~year
,value.var = c("OffenseCount"))
#Differnces
comp_ytds$diff_prior<-comp_ytds$'2023'-comp_ytds$'2022'
comp_ytds$diff_base<-comp_ytds$'2023'-comp_ytds$'2019'
#POPUP
comp_ytds$popup<-paste("<b>HPD Beat: </b>", comp_ytds$Beat, "<br>",
"<br>", "<b>Change from Last Year: </b>", comp_ytds$diff_prior,
"<br>", "<b>Change from 2019: </b>", comp_ytds$diff_base,
"<br>", "<b>Offense Count 2019: </b>", comp_ytds$'2019',
"<br>", "<b>Offense Count 2022: </b>", comp_ytds$'2022',
"<br>", "<b>Offense Count 2023: </b>", comp_ytds$'2023')
#Merge GeoJson to DataTable
final<-geo_join( beats
,comp_ytds
,"Beats"
,"Beat")
#Get Bounds for custom bins
min_bin<-min(comp_ytds$diff_prior,na.rm=TRUE)
max_bin<-max(comp_ytds$diff_prior,na.rm=TRUE)
c_bins=c( min_bin
,(min_bin%/%3)*2
,min_bin%/%3
,0
,max_bin%/%3
,(max_bin%/%3)*2
,max_bin)
# Creating a color palette, with custom bins, based on differnce from prior year
pal <- colorBin( "RdYlBu"
,domain=final$OffenseCount
,c_bins
,pretty = FALSE)
leaflet() %>%
addTiles()%>%
addTiles(group = "OSM (default)") %>%
addProviderTiles(provider = "Esri.WorldStreetMap",group = "World StreetMap") %>%
addProviderTiles(provider = "Esri.WorldImagery",group = "World Imagery") %>%
addLayersControl(
baseGroups = c("OSM (default)","World StreetMap", "World Imagery"),
options = layersControlOptions(collapsed = FALSE))%>%
addPolygons(data = final ,
fillColor = ~pal(final$diff_prior),
fillOpacity = 0.7,
weight = 0.2,
smoothFactor = 0.2,
popup = ~popup) %>%
addLegend(pal = pal,
values = final$diff_prior,
position = "bottomright",
title = "YTD Changes in Violent Crime Counts")
library(leaflet)
districts<-rgdal::readOGR("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]
data$Address<-paste( data$StreetNo
,' '
,data$StreetName
,' '
,data$StreetType
,' '
,data$Suffix)
data$popup<-paste("<b>Incident #: </b>", data$Incident, "<br>",
"<br>", "<b>Description: </b>", data$NIBRSDescription,
"<br>", "<b>Date: </b>", data$RMSOccurrenceDate,
"<br>", "<b>Time: </b>", data$RMSOccurrenceHour,
"<br>", "<b>HPD Beat: </b>", data$Beat,
"<br>", "<b>Address: </b>", data$Address,
"<br>", "<b>Longitude: </b>", data$MapLongitude,
"<br>", "<b>Latitude: </b>", data$MapLatitude)
data%>%leaflet()%>%
addTiles()%>%
addTiles(group = "OSM (default)") %>%
addProviderTiles(provider = "Esri.WorldStreetMap",group = "World StreetMap") %>%
addProviderTiles(provider = "Esri.WorldImagery",group = "World Imagery") %>%
# addProviderTiles(provider = "NASAGIBS.ViirsEarthAtNight2012",group = "Nighttime Imagery") %>%
addMarkers( lng = ~MapLongitude
,lat = ~MapLatitude
,popup=data$popup
,clusterOptions=markerClusterOptions()) %>%
addLayersControl(
baseGroups = c("OSM (default)","World StreetMap", "World Imagery"),
options = layersControlOptions(collapsed = FALSE))%>%
addPolygons( data=districts
,fill=T
,color="grey"
,opacity=1
,weight=2)
library('tigris')
bas_yr='2019'
pri_yr='2022'
cur_yr='2023'
latest_mon='06'
base_end_dt<-round_date(as.Date(ISOdate( year=bas_yr
,month=latest_mon
,day='28')),'month')-days(1)
pri_end_dt<-round_date(as.Date(ISOdate( year=pri_yr
,month=latest_mon
,day='28')),'month')-days(1)
cur_end_dt<-round_date(as.Date(ISOdate( year=cur_yr
,month=latest_mon
,day='28')),'month')-days(1)
incidents_ytd<-multi_year[ (NIBRSDescription %chin% violent_crimes),]%>%
.[( RMSOccurrenceDate>=glue('{bas_yr}-01-01')
&RMSOccurrenceDate<=base_end_dt)
|( RMSOccurrenceDate>=glue('{pri_yr}-01-01')
&RMSOccurrenceDate<=pri_end_dt)
|( RMSOccurrenceDate>=glue('{cur_yr}-01-01')
&RMSOccurrenceDate<=cur_end_dt),]
#Aggregate
incidents_ytd_agg<-incidents_ytd[,.(OffenseCount=sum(OffenseCount))
,by=list(Beat,year)]
#Transpose Column per year
comp_ytds<-dcast( incidents_ytd_agg
,Beat~year
,value.var = c("OffenseCount"))
#Differnces
comp_ytds$diff_prior<-comp_ytds$'2023'-comp_ytds$'2022'
comp_ytds$diff_base<-comp_ytds$'2023'-comp_ytds$'2019'
#POPUP
comp_ytds$popup<-paste("<b>HPD Beat: </b>", comp_ytds$Beat, "<br>",
"<br>", "<b>Change from Last Year: </b>", comp_ytds$diff_prior,
"<br>", "<b>Change from 2019: </b>", comp_ytds$diff_base,
"<br>", "<b>Offense Count 2019: </b>", comp_ytds$'2019',
"<br>", "<b>Offense Count 2022: </b>", comp_ytds$'2022',
"<br>", "<b>Offense Count 2023: </b>", comp_ytds$'2023')
#Merge GeoJson to DataTable
final<-geo_join( beats
,comp_ytds
,"Beats"
,"Beat")
#Get Bounds for custom bins
min_bin<-min(comp_ytds$diff_prior,na.rm=TRUE)
max_bin<-max(comp_ytds$diff_prior,na.rm=TRUE)
c_bins=c( min_bin
,(min_bin%/%3)*2
,min_bin%/%3
,0
,max_bin%/%3
,(max_bin%/%3)*2
,max_bin)
# Creating a color palette, with custom bins, based on differnce from prior year
pal <- colorBin( "RdYlBu"
,domain=final$OffenseCount
,c_bins
,pretty = FALSE)
leaflet() %>%
addTiles()%>%
addTiles(group = "OSM (default)") %>%
addProviderTiles(provider = "Esri.WorldStreetMap",group = "World StreetMap") %>%
addProviderTiles(provider = "Esri.WorldImagery",group = "World Imagery") %>%
addLayersControl(
baseGroups = c("OSM (default)","World StreetMap", "World Imagery"),
options = layersControlOptions(collapsed = FALSE))%>%
addPolygons(data = final ,
fillColor = ~pal(final$diff_prior),
fillOpacity = 0.7,
weight = 1.0,
smoothFactor = 0.2,
popup = ~popup) %>%
addLegend(pal = pal,
values = final$diff_prior,
position = "bottomright",
title = "YTD Changes in Violent Crime Counts")
library(leaflet)
districts<-rgdal::readOGR("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]
data$Address<-paste( data$StreetNo
,' '
,data$StreetName
,' '
,data$StreetType
,' '
,data$Suffix)
data$popup<-paste("<b>Incident #: </b>", data$Incident, "<br>",
"<br>", "<b>Description: </b>", data$NIBRSDescription,
"<br>", "<b>Date: </b>", data$RMSOccurrenceDate,
"<br>", "<b>Time: </b>", data$RMSOccurrenceHour,
"<br>", "<b>HPD Beat: </b>", data$Beat,
"<br>", "<b>Address: </b>", data$Address,
"<br>", "<b>Longitude: </b>", data$MapLongitude,
"<br>", "<b>Latitude: </b>", data$MapLatitude)
data%>%leaflet()%>%
addTiles()%>%
addTiles(group = "OSM (default)") %>%
addProviderTiles(provider = "Esri.WorldStreetMap",group = "World StreetMap") %>%
addProviderTiles(provider = "Esri.WorldImagery",group = "World Imagery") %>%
# addProviderTiles(provider = "NASAGIBS.ViirsEarthAtNight2012",group = "Nighttime Imagery") %>%
addMarkers( lng = ~MapLongitude
,lat = ~MapLatitude
,popup=data$popup
,clusterOptions=markerClusterOptions()) %>%
addLayersControl(
baseGroups = c("OSM (default)","World StreetMap", "World Imagery"),
options = layersControlOptions(collapsed = FALSE))%>%
addPolygons( data=districts
,fill=T
,color="grey"
,opacity=1
,weight=2)
library(leaflet)
library(sf)
districts<-rgdal::readOGR("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
districts2<-st_read("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
library(leaflet)
library(sf)
districts<-rgdal::readOGR("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
districts2<-st_read("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]
# Add Use LONG/Lat to assign districts
data$Address<-paste( data$StreetNo
,' '
,data$StreetName
,' '
,data$StreetType
,' '
,data$Suffix)
data$popup<-paste("<b>Incident #: </b>", data$Incident, "<br>",
"<br>", "<b>Description: </b>", data$NIBRSDescription,
"<br>", "<b>Date: </b>", data$RMSOccurrenceDate,
"<br>", "<b>Time: </b>", data$RMSOccurrenceHour,
"<br>", "<b>HPD Beat: </b>", data$Beat,
"<br>", "<b>Address: </b>", data$Address,
"<br>", "<b>Longitude: </b>", data$MapLongitude,
"<br>", "<b>Latitude: </b>", data$MapLatitude)
data%>%leaflet()%>%
addTiles()%>%
addTiles(group = "OSM (default)") %>%
addProviderTiles(provider = "Esri.WorldStreetMap",group = "World StreetMap") %>%
addProviderTiles(provider = "Esri.WorldImagery",group = "World Imagery") %>%
# addProviderTiles(provider = "NASAGIBS.ViirsEarthAtNight2012",group = "Nighttime Imagery") %>%
addMarkers( lng = ~MapLongitude
,lat = ~MapLatitude
,popup=data$popup
,clusterOptions=markerClusterOptions()) %>%
addLayersControl(
baseGroups = c("OSM (default)","World StreetMap", "World Imagery"),
options = layersControlOptions(collapsed = FALSE))%>%
addPolygons( data=districts2
,fill=T
,color="grey"
,opacity=1
,weight=2)
library("readxl")
library("glue")
library("tidyverse")
library("data.table")
library("zoo")
library("ggplot2")
library("ggthemes")
library("leaflet")
library('sf')
theme_update(plot.title = element_text(hjust = 0.5))
where_the_data_is<-'C:/Users/chris/Documents/Random_Nextdoor/My_Crime_Analysis - 05.04.23/Group/Data/HPD_NIBRS/'
support_dir<-'C:/Users/chris/Documents/GitHub/HoustonCrimeDataAnalysis/DATA/Support/'
districts<-rgdal::readOGR(glue("{support_dir}COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson"))
beats<-rgdal::readOGR(glue("{support_dir}COH_POLICE_BEATS.geojson"))
bydim<-'Overall'
group_dims<-c('NIBRSDescription',bydim)
violent_crimes<-c('Aggravated Assault'
,'Forcible rape'
,'Robbery'
,'Murder, non-negligent')
baseline<-read_excel(glue('{where_the_data_is}2019_NIBRSPublicView.Jan1-Dec31.xlsx'))%>%
rename( OffenseCount=`Offense\r\nCount`
,RMSOccurrenceDate=`Occurrence\r\nDate`
,ZIPCode=`ZIP Code`
,StreetType=`Street\r\nType`
,RMSOccurrenceHour=`Occurrence\r\nHour`
,NIBRSClass=`NIBRS\r\nClass`
,StreetNo=`Block Range`)
baseline$MapLongitude<-NA
baseline$MapLatitude<-NA
min(baseline$RMSOccurrenceDate)
max(baseline$RMSOccurrenceDate)
year1<-read_excel(glue('{where_the_data_is}NIBRSPublicView.Jan1-Dec31-2020.xlsx'))%>%
rename( OffenseCount=`Offense\r\nCount`
,RMSOccurrenceDate=`Occurrence\r\nDate`
,ZIPCode=`ZIP Code`
,StreetType=`Street\r\nType`
,RMSOccurrenceHour=`Occurrence\r\nHour`
,NIBRSClass=`NIBRS\r\nClass`
,StreetNo=`Block Range`)
year1$MapLongitude<-NA
year1$MapLatitude<-NA
min(year1$RMSOccurrenceDate)
max(year1$RMSOccurrenceDate)
year2<-read_excel(glue('{where_the_data_is}NIBRSPublicViewDec21.xlsx'))
year2$MapLongitude<-NA
year2$MapLatitude<-NA
min(year2$RMSOccurrenceDate)
max(year2$RMSOccurrenceDate)
year3<-read_excel(glue('{where_the_data_is}NIBRSPublicViewDec22.xlsx'))
min(year3$RMSOccurrenceDate)
max(year3$RMSOccurrenceDate)
year4<-read_excel(glue('{where_the_data_is}NIBRSPublicViewJun23.xlsx'))
min(year4$RMSOccurrenceDate)
max(year4$RMSOccurrenceDate)
multi_year<-rbind(baseline,year1,year2,year3,year4)%>%
mutate(year_mon=floor_date(RMSOccurrenceDate,'month'))
multi_year$year<-year(multi_year$RMSOccurrenceDate)
multi_year$Overall<-'OverAll'
setDT(multi_year)
qa_year_mon<-multi_year%>%group_by(year_mon)%>%summarize(freq=n())
qa_year<-multi_year%>%group_by(year)%>%summarize(freq=n())
qa_year_by_year_mon<-multi_year%>%group_by(year_mon,year)%>%summarize(freq=n())
districts<-st_read("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]
# Add Use LONG/Lat to assign districts
# Add Use LONG/Lat to assign districts
data%>%st_as_sf(coords=c("MapLongitude","MapLatitude"), crs=4326, remove=FALSE)
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]%>%
.[(multi_year$MapLongitude!is.na())|(multi_year$MapLatitude!is.na())]
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]%>%
.[(MapLongitude!is.na())|(MapLatitude!is.na())]
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]%>%
.[(!is.na(MapLongitude))|(!is.na(MapLatitude))]
View(data)
View(data)
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]%>%
.[(!is.na(MapLongitude))|(!is.na(MapLatitude))]
# Add Use LONG/Lat to assign districts
data%>%st_as_sf(coords=c("MapLongitude","MapLatitude"), crs=4326, remove=FALSE)
districts<-st_read("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]%>%
.[(!is.na(MapLongitude))|(!is.na(MapLatitude))]
# Add Use LONG/Lat to assign districts
data$coords%>%st_as_sf(coords=c("MapLongitude","MapLatitude"), crs=4326, remove=FALSE)
# Add Use LONG/Lat to assign districts
data$coords<-st_as_sf(coords=c("MapLongitude","MapLatitude"), crs=4326, remove=FALSE)
# Add Use LONG/Lat to assign districts
data$coords<-data%>%st_as_sf(coords=c("MapLongitude","MapLatitude"), crs=4326, remove=FALSE)
data%>%st_as_sf(coords=c("MapLongitude","MapLatitude"), crs=4326, remove=FALSE)
x<-data%>%st_as_sf(coords=c("MapLongitude","MapLatitude"), crs=4326, remove=FALSE)
View(x)
View(x)
data<-multi_year[ (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]%>%
.[(!is.na(MapLongitude))|(!is.na(MapLatitude))]%>%
st_as_sf(coords=c("MapLongitude","MapLatitude"), crs=4326, remove=FALSE)
st_join(data,districts)
is_in<-st_join(data, districts, join = st_within)
sf_use_s2(FALSE)
is_in<-st_join(data, districts, join = st_within)
View(is_in)
View(is_in)
sf_use_s2(FALSE)
districts<-st_read("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
data_pre<-multi_year[  (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]%>%
.[ (!is.na(MapLongitude))
|(!is.na(MapLatitude))]%>%
st_as_sf( coords=c("MapLongitude","MapLatitude")
,crs=4326
,remove=FALSE)
data<-st_join( data_pre
,districts
,join = st_within)
data$Address<-paste( data$StreetNo
,' '
,data$StreetName
,' '
,data$StreetType
,' '
,data$Suffix)
data$popup<-paste("<b>Incident #: </b>", data$Incident, "<br>",
"<br>", "<b>Description: </b>", data$NIBRSDescription,
"<br>", "<b>Date: </b>", data$RMSOccurrenceDate,
"<br>", "<b>Time: </b>", data$RMSOccurrenceHour,
"<br>", "<b>HPD Beat: </b>", data$Beat,
"<br>", "<b>Address: </b>", data$Address,
"<br>", "<b>Longitude: </b>", data$MapLongitude,
"<br>", "<b>Latitude: </b>", data$MapLatitude)
data%>%leaflet()%>%
addTiles()%>%
addTiles(group = "OSM (default)") %>%
addProviderTiles(provider = "Esri.WorldStreetMap",group = "World StreetMap") %>%
addProviderTiles(provider = "Esri.WorldImagery",group = "World Imagery") %>%
# addProviderTiles(provider = "NASAGIBS.ViirsEarthAtNight2012",group = "Nighttime Imagery") %>%
addMarkers( lng = ~MapLongitude
,lat = ~MapLatitude
,popup=data$popup
,clusterOptions=markerClusterOptions()) %>%
addLayersControl(
baseGroups = c("OSM (default)","World StreetMap", "World Imagery"),
options = layersControlOptions(collapsed = FALSE))%>%
addPolygons( data=districts
,fill=T
,color="grey"
,opacity=1
,weight=2)
View(data)
View(data)
sf_use_s2(FALSE)
districts<-st_read("C:/Users/chris/Downloads/COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson")
data_pre<-multi_year[  (NIBRSDescription %chin% violent_crimes)
&(RMSOccurrenceDate>='2023-06-01')
,]%>%
.[ (!is.na(MapLongitude))
|(!is.na(MapLatitude))]%>%
st_as_sf( coords=c("MapLongitude","MapLatitude")
,crs=4326
,remove=FALSE)
data<-st_join( data_pre
,districts
,join = st_within)
data$Address<-paste( data$StreetNo
,' '
,data$StreetName
,' '
,data$StreetType
,' '
,data$Suffix)
data$popup<-paste("<b>Incident #: </b>", data$Incident, "<br>",
"<br>", "<b>Description: </b>", data$NIBRSDescription,
"<br>", "<b>Date: </b>", data$RMSOccurrenceDate,
"<br>", "<b>Time: </b>", data$RMSOccurrenceHour,
"<br>", "<b>Council District: </b>",data$DISTRICT,
"<br>", "<b>HPD Beat: </b>", data$Beat,
"<br>", "<b>Address: </b>", data$Address,
"<br>", "<b>Longitude: </b>", data$MapLongitude,
"<br>", "<b>Latitude: </b>", data$MapLatitude)
data%>%leaflet()%>%
addTiles()%>%
addTiles(group = "OSM (default)") %>%
addProviderTiles(provider = "Esri.WorldStreetMap",group = "World StreetMap") %>%
addProviderTiles(provider = "Esri.WorldImagery",group = "World Imagery") %>%
# addProviderTiles(provider = "NASAGIBS.ViirsEarthAtNight2012",group = "Nighttime Imagery") %>%
addMarkers( lng = ~MapLongitude
,lat = ~MapLatitude
,popup=data$popup
,clusterOptions=markerClusterOptions()) %>%
addLayersControl(
baseGroups = c("OSM (default)","World StreetMap", "World Imagery"),
options = layersControlOptions(collapsed = FALSE))%>%
addPolygons( data=districts
,fill=T
,color="grey"
,opacity=1
,weight=2)
