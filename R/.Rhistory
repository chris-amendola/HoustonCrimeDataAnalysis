geom_hline(yintercept=start_val, linetype="dashed", color = "darkgreen")+
geom_hline(yintercept=end_value, linetype="dashed", color = "red")+
geom_hline(yintercept=max_value, linetype="dashed", color = "blue")+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.5))+
ylab("Rolling 12 Month Average")
}
#NIBRS_Trend(crimes_filtered)
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(crimes_filtered)
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(crimes_filtered)
NIBRS_YTD()
NIBRS_YTD<- function( bas_yr='2019'
,pri_yr='2022'
,cur_yr='2023'
,latest_mon='06') {
#2019
base_end_dt<-round_date(as.Date(ISOdate( year=bas_yr
,month=latest_mon
,day='28')),'month')-days(1)
bas_agg<-crimes_filtered[ (RMSOccurrenceDate>=glue('{bas_yr}-01-01')
&RMSOccurrenceDate<=base_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#2022
pri_end_dt<-round_date(as.Date(ISOdate( year=pri_yr
,month=latest_mon
,day='28')),'month')-days(1)
pri_agg<-crimes_filtered[ (RMSOccurrenceDate>=glue('{pri_yr}-01-01')
&RMSOccurrenceDate<=pri_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#2023
cur_end_dt<-round_date(as.Date(ISOdate( year=cur_yr
,month=latest_mon
,day='28')),'month')-days(1)
cur_agg<-crimes_filtered[ (RMSOccurrenceDate>=glue('{cur_yr}-01-01')
&RMSOccurrenceDate<=cur_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#Prep for Plotting
bas_agg[,'Year':=bas_yr]
pri_agg[,'Year':=pri_yr]
cur_agg[,'Year':=cur_yr]
plot_prep<- rbindlist(list(bas_agg,pri_agg,cur_agg))
ggplot( data=plot_prep
,aes( y=OffenseCount
,x=Year
,fill=Year))+
geom_bar( position="dodge"
,stat="identity")+
ggtitle("Year-To-Date")+
theme_economist()+
scale_fill_manual(values=c('darkblue', 'darkgreen', 'darkred'))
}
#NIBRS_YTD()
#Prepare for comparison
#setnames(bas_agg, "OffenseCount", glue("OffenseCount_bas"))
#setnames(pri_agg, "OffenseCount", glue("OffenseCount_pri"))
#setnames(cur_agg, "OffenseCount", glue("OffenseCount_cur"))
#comp_ytds<-bas_agg[pri_agg,on=group_dims]%>%
#  .[cur_agg,on=group_dims]
#comp_ytds[,'diff_pri':=OffenseCount_cur-OffenseCount_pri]
#comp_ytds[,'diff_bas':=OffenseCount_cur-OffenseCount_bas]
#comp_ytds[,'perc_pri':=diff_pri/OffenseCount_cur]
#comp_ytds[,'perc_bas':=diff_bas/OffenseCount_pri]
#setnames( comp_ytds
#          ,c("OffenseCount_bas","OffenseCount_pri","OffenseCount_cur")
#          ,c( glue("OffenseCount_{bas_yr}")#
#              ,glue("OffenseCount_{pri_yr}")
#              ,glue("OffenseCount_{cur_yr}")))
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(crimes_filtered)
NIBRS_YTD()
NIBRS_YTD<- function( indata=crimes_filtered
,bas_yr='2019'
,pri_yr='2022'
,cur_yr='2023'
,latest_mon='06') {
#2019
base_end_dt<-round_date(as.Date(ISOdate( year=bas_yr
,month=latest_mon
,day='28')),'month')-days(1)
bas_agg<-indata[ (RMSOccurrenceDate>=glue('{bas_yr}-01-01')
&RMSOccurrenceDate<=base_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#2022
pri_end_dt<-round_date(as.Date(ISOdate( year=pri_yr
,month=latest_mon
,day='28')),'month')-days(1)
pri_agg<-indata[ (RMSOccurrenceDate>=glue('{pri_yr}-01-01')
&RMSOccurrenceDate<=pri_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#2023
cur_end_dt<-round_date(as.Date(ISOdate( year=cur_yr
,month=latest_mon
,day='28')),'month')-days(1)
cur_agg<-indata[ (RMSOccurrenceDate>=glue('{cur_yr}-01-01')
&RMSOccurrenceDate<=cur_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#Prep for Plotting
bas_agg[,'Year':=bas_yr]
pri_agg[,'Year':=pri_yr]
cur_agg[,'Year':=cur_yr]
plot_prep<- rbindlist(list(bas_agg,pri_agg,cur_agg))
ggplot( data=plot_prep
,aes( y=OffenseCount
,x=Year
,fill=Year))+
geom_bar( position="dodge"
,stat="identity")+
ggtitle("Year-To-Date")+
theme_economist()+
scale_fill_manual(values=c('darkblue', 'darkgreen', 'darkred'))
}
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(crimes_filtered)
NIBRS_YTD()
## Individual Crimes
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]
for (icrime in violent_crimes) {
}
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
## Individual Crimes
for (icrime in violent_crimes) {
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:=icrime]
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
## Individual Crimes
for (icrime in violent_crimes) {
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:=icrime]
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
## Individual Crimes
for (icrime in violent_crimes) {
crimes_filtered<-multi_year[NIBRSDescription==icrime]%>%
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
NIBRS_YTD<- function( indata=crimes_filtered
,bas_yr='2019'
,pri_yr='2022'
,cur_yr='2023'
,latest_mon='06') {
#2019
base_end_dt<-round_date(as.Date(ISOdate( year=bas_yr
,month=latest_mon
,day='28')),'month')-days(1)
bas_agg<-indata[ (RMSOccurrenceDate>=glue('{bas_yr}-01-01')
&RMSOccurrenceDate<=base_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#2022
pri_end_dt<-round_date(as.Date(ISOdate( year=pri_yr
,month=latest_mon
,day='28')),'month')-days(1)
pri_agg<-indata[ (RMSOccurrenceDate>=glue('{pri_yr}-01-01')
&RMSOccurrenceDate<=pri_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#2023
cur_end_dt<-round_date(as.Date(ISOdate( year=cur_yr
,month=latest_mon
,day='28')),'month')-days(1)
cur_agg<-indata[ (RMSOccurrenceDate>=glue('{cur_yr}-01-01')
&RMSOccurrenceDate<=cur_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#Prep for Plotting
bas_agg[,'Year':=bas_yr]
pri_agg[,'Year':=pri_yr]
cur_agg[,'Year':=cur_yr]
plot_prep<- rbindlist(list(bas_agg,pri_agg,cur_agg))
ggplot( data=plot_prep
,aes( y=OffenseCount
,x=Year
,fill=Year))+
geom_bar( position="dodge"
,stat="identity")+
ggtitle("Year-To-Date")+
theme_economist()+
scale_fill_manual(values=c('darkblue', 'darkgreen', 'darkred'))
}
#NIBRS_YTD()
#Prepare for comparison
#setnames(bas_agg, "OffenseCount", glue("OffenseCount_bas"))
#setnames(pri_agg, "OffenseCount", glue("OffenseCount_pri"))
#setnames(cur_agg, "OffenseCount", glue("OffenseCount_cur"))
#comp_ytds<-bas_agg[pri_agg,on=group_dims]%>%
#  .[cur_agg,on=group_dims]
#comp_ytds[,'diff_pri':=OffenseCount_cur-OffenseCount_pri]
#comp_ytds[,'diff_bas':=OffenseCount_cur-OffenseCount_bas]
#comp_ytds[,'perc_pri':=diff_pri/OffenseCount_cur]
#comp_ytds[,'perc_bas':=diff_bas/OffenseCount_pri]
#setnames( comp_ytds
#          ,c("OffenseCount_bas","OffenseCount_pri","OffenseCount_cur")
#          ,c( glue("OffenseCount_{bas_yr}")#
#              ,glue("OffenseCount_{pri_yr}")
#              ,glue("OffenseCount_{cur_yr}")))
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
## Individual Crimes
for (icrime in violent_crimes) {
crimes_filtered<-multi_year[NIBRSDescription==icrime]%>%
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
## Individual Crimes
for (icrime in violent_crimes) {
print(icrime)
crimes_filtered<-multi_year[NIBRSDescription==icrime]%>%
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
NIBRS_Trend<- function(indata) {
data<-indata[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,Rolling_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
start_val<-data[year_mon==min(year_mon)][[1,3]]
max_value<-data[Rolling_12_Month==max(Rolling_12_Month)][[1,3]]
min_value<-data[Rolling_12_Month==min(Rolling_12_Month)][[1,3]]
end_value<-data[year_mon==max(year_mon)][[1,3]]
ggplot(data=data, aes(x=year_mon, y=Rolling_12_Month, group=1))+
ggtitle('Violent\n\rOverall')+
geom_line(color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
geom_hline(yintercept=start_val, linetype="dashed", color = "darkgreen")+
geom_hline(yintercept=end_value, linetype="dashed", color = "red")+
geom_hline(yintercept=max_value, linetype="dashed", color = "blue")+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.5))+
ylab("Rolling 12 Month Average")
}
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
## Individual Crimes
for (icrime in violent_crimes) {
print(icrime)
crimes_filtered<-multi_year[NIBRSDescription==icrime]%>%
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
NIBRS_Trend(crimes_filtered)
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
## Individual Crimes
for (icrime in violent_crimes) {
print(icrime)
crimes_filtered<-multi_year[NIBRSDescription==icrime]
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
NIBRS_Trend<- function( indata
,title1='title1') {
data<-indata[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,Rolling_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
start_val<-data[year_mon==min(year_mon)][[1,3]]
max_value<-data[Rolling_12_Month==max(Rolling_12_Month)][[1,3]]
min_value<-data[Rolling_12_Month==min(Rolling_12_Month)][[1,3]]
end_value<-data[year_mon==max(year_mon)][[1,3]]
ggplot(data=data, aes(x=year_mon, y=Rolling_12_Month, group=1))+
ggtitle(glue('Violent\n\r{title1}'))+
geom_line(color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
geom_hline(yintercept=start_val, linetype="dashed", color = "darkgreen")+
geom_hline(yintercept=end_value, linetype="dashed", color = "red")+
geom_hline(yintercept=max_value, linetype="dashed", color = "blue")+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.5))+
ylab("Rolling 12 Month Average")
}
#NIBRS_Trend(crimes_filtered,'Violent')
NIBRS_YTD<- function( indata
,title1='title1'
,bas_yr='2019'
,pri_yr='2022'
,cur_yr='2023'
,latest_mon='06') {
#2019
base_end_dt<-round_date(as.Date(ISOdate( year=bas_yr
,month=latest_mon
,day='28')),'month')-days(1)
bas_agg<-indata[ (RMSOccurrenceDate>=glue('{bas_yr}-01-01')
&RMSOccurrenceDate<=base_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#2022
pri_end_dt<-round_date(as.Date(ISOdate( year=pri_yr
,month=latest_mon
,day='28')),'month')-days(1)
pri_agg<-indata[ (RMSOccurrenceDate>=glue('{pri_yr}-01-01')
&RMSOccurrenceDate<=pri_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#2023
cur_end_dt<-round_date(as.Date(ISOdate( year=cur_yr
,month=latest_mon
,day='28')),'month')-days(1)
cur_agg<-indata[ (RMSOccurrenceDate>=glue('{cur_yr}-01-01')
&RMSOccurrenceDate<=cur_end_dt)
,.(OffenseCount=sum(OffenseCount))
,by=group_dims]
#Prep for Plotting
bas_agg[,'Year':=bas_yr]
pri_agg[,'Year':=pri_yr]
cur_agg[,'Year':=cur_yr]
plot_prep<- rbindlist(list(bas_agg,pri_agg,cur_agg))
ggplot( data=plot_prep
,aes( y=OffenseCount
,x=Year
,fill=Year))+
geom_bar( position="dodge"
,stat="identity")+
ggtitle("Year-To-Date")+
theme_economist()+
scale_fill_manual(values=c('darkblue', 'darkgreen', 'darkred'))
}
#NIBRS_YTD()
#Prepare for comparison
#setnames(bas_agg, "OffenseCount", glue("OffenseCount_bas"))
#setnames(pri_agg, "OffenseCount", glue("OffenseCount_pri"))
#setnames(cur_agg, "OffenseCount", glue("OffenseCount_cur"))
#comp_ytds<-bas_agg[pri_agg,on=group_dims]%>%
#  .[cur_agg,on=group_dims]
#comp_ytds[,'diff_pri':=OffenseCount_cur-OffenseCount_pri]
#comp_ytds[,'diff_bas':=OffenseCount_cur-OffenseCount_bas]
#comp_ytds[,'perc_pri':=diff_pri/OffenseCount_cur]
#comp_ytds[,'perc_bas':=diff_bas/OffenseCount_pri]
#setnames( comp_ytds
#          ,c("OffenseCount_bas","OffenseCount_pri","OffenseCount_cur")
#          ,c( glue("OffenseCount_{bas_yr}")#
#              ,glue("OffenseCount_{pri_yr}")
#              ,glue("OffenseCount_{cur_yr}")))
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered,'Violent')
NIBRS_YTD(indata=crimes_filtered,'Violent')
NIBRS_Trend<- function( indata
,title1='title1') {
data<-indata[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,Rolling_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
start_val<-data[year_mon==min(year_mon)][[1,3]]
max_value<-data[Rolling_12_Month==max(Rolling_12_Month)][[1,3]]
min_value<-data[Rolling_12_Month==min(Rolling_12_Month)][[1,3]]
end_value<-data[year_mon==max(year_mon)][[1,3]]
ggplot(data=data, aes(x=year_mon, y=Rolling_12_Month, group=1))+
ggtitle(glue('{title1}\n\rOverall'))+
geom_line(color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
geom_hline(yintercept=start_val, linetype="dashed", color = "darkgreen")+
geom_hline(yintercept=end_value, linetype="dashed", color = "red")+
geom_hline(yintercept=max_value, linetype="dashed", color = "blue")+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.5))+
ylab("Rolling 12 Month Average")
}
#NIBRS_Trend(crimes_filtered,'Violent')
## Overall Violent
crimes_filtered<-multi_year[NIBRSDescription %chin% violent_crimes]%>%
.[,NIBRSDescription:='Violent']
NIBRS_Trend(indata=crimes_filtered,'Violent')
NIBRS_YTD(indata=crimes_filtered,'Violent')
## Individual Crimes
for (icrime in violent_crimes) {
print(icrime)
crimes_filtered<-multi_year[NIBRSDescription==icrime]
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
## Individual Crimes
for (icrime in violent_crimes) {
print(icrime)
crimes_filtered<-multi_year[NIBRSDescription==icrime]
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
for (icrime in violent_crimes) {
print(icrime)
crimes_filtered<-multi_year[NIBRSDescription==icrime]
nrow(crimes_filtered)
## Individual Crimes
for (icrime in violent_crimes) {
print(icrime)
crimes_filtered<-multi_year[NIBRSDescription==icrime]
nrow(crimes_filtered)
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
## Individual Crimes
for (icrime in violent_crimes) {
print(icrime)
crimes_filtered<-multi_year[NIBRSDescription==icrime]
nrow(crimes_filtered)
NIBRS_Trend(indata=crimes_filtered)
NIBRS_YTD(indata=crimes_filtered)
}
library("readxl")
library("glue")
library("tidyverse")
library("data.table")
library("zoo")
library("ggplot2")
library("ggthemes")
library("leaflet")
library('sf')
#theme_update(plot.title = element_text(hjust = 0.5))
where_the_data_is<-'C:/Users/chris/Documents/Random_Nextdoor/My_Crime_Analysis - 05.04.23/Group/Data/HPD_NIBRS/'
support_dir<-'C:/Users/chris/Documents/GitHub/HoustonCrimeDataAnalysis/DATA/Support/'
districts<-rgdal::readOGR(glue("{support_dir}COH_ADMINISTRATIVE_BOUNDARY_-_MIL.geojson"))
beats<-rgdal::readOGR(glue("{support_dir}COH_POLICE_BEATS.geojson"))
bydim<-'Overall'
group_dims<-c('NIBRSDescription',bydim)
violent_crimes<-c('Aggravated Assault'
,'Forcible rape'
,'Robbery'
,'Murder, non-negligent')
baseline<-read_excel(glue('{where_the_data_is}2019_NIBRSPublicView.Jan1-Dec31.xlsx'))%>%
rename( OffenseCount=`Offense\r\nCount`
,RMSOccurrenceDate=`Occurrence\r\nDate`
,ZIPCode=`ZIP Code`
,StreetType=`Street\r\nType`
,RMSOccurrenceHour=`Occurrence\r\nHour`
,NIBRSClass=`NIBRS\r\nClass`
,StreetNo=`Block Range`)
baseline$MapLongitude<-NA
baseline$MapLatitude<-NA
min(baseline$RMSOccurrenceDate)
max(baseline$RMSOccurrenceDate)
year1<-read_excel(glue('{where_the_data_is}NIBRSPublicView.Jan1-Dec31-2020.xlsx'))%>%
rename( OffenseCount=`Offense\r\nCount`
,RMSOccurrenceDate=`Occurrence\r\nDate`
,ZIPCode=`ZIP Code`
,StreetType=`Street\r\nType`
,RMSOccurrenceHour=`Occurrence\r\nHour`
,NIBRSClass=`NIBRS\r\nClass`
,StreetNo=`Block Range`)
year1$MapLongitude<-NA
year1$MapLatitude<-NA
min(year1$RMSOccurrenceDate)
max(year1$RMSOccurrenceDate)
year2<-read_excel(glue('{where_the_data_is}NIBRSPublicViewDec21.xlsx'))
year2$MapLongitude<-NA
year2$MapLatitude<-NA
min(year2$RMSOccurrenceDate)
max(year2$RMSOccurrenceDate)
year3<-read_excel(glue('{where_the_data_is}NIBRSPublicViewDec22.xlsx'))
min(year3$RMSOccurrenceDate)
max(year3$RMSOccurrenceDate)
year4<-read_excel(glue('{where_the_data_is}NIBRSPublicViewJun23.xlsx'))
min(year4$RMSOccurrenceDate)
max(year4$RMSOccurrenceDate)
multi_year<-rbind(baseline,year1,year2,year3,year4)%>%
mutate(year_mon=floor_date(RMSOccurrenceDate,'month'))
multi_year$year<-year(multi_year$RMSOccurrenceDate)
multi_year$Overall<-'OverAll'
setDT(multi_year)
qa_year_mon<-multi_year%>%group_by(year_mon)%>%summarize(freq=n())
qa_year<-multi_year%>%group_by(year)%>%summarize(freq=n())
qa_year_by_year_mon<-multi_year%>%group_by(year_mon,year)%>%summarize(freq=n())
