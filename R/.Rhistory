Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
#Filter
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
#Aggregate/Reduce
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
ggplot(data=df, aes(x=year_mon, group=1))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
geom_line(aes( y=Rhodium),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
#Filter
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
#Aggregate/Reduce
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
ggplot(data=df, aes(x=year_mon, group=1))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
View(df)
View(df)
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
#Filter
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
#Aggregate/Reduce
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
ggplot(data=df, aes(x=year_mon, group=1))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
View(all_prem)
View(df)
View(df)
melt( df
,measure.vars=c("Rhodium_Price","CC_Theft")
,id.vars= c("year_mon"))
ggplot(data=df, aes(x=year_mon, group=1))
ggplot(data=df, aes(x=year_mon, group=1))+geom_line()
View(df)
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
df<-melt( df
,measure.vars=c("Rhodium_Price","CC_Theft")
,id.vars= c("year_mon"))
View(df)
ggplot(data=df, aes(x=year_mon,y=value, group=variable))+geom_line()
ggplot(data=df, aes(x=year_mon,y=value, group=variable))+geom_line()
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
#geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
#geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
ggplot(data=df, aes(x=year_mon,y=value, group=variable))+geom_line()+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
#geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
#geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
ggplot(data=df, aes(x=year_mon,y=value, group=variable))+geom_line(linewidth=1, alpha=0.9, linetype=1)+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
#geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
#geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
ggplot(data=df, aes(x=year_mon,y=value, group=variable,color=c("darkblue","red")))+geom_line(linewidth=1, alpha=0.9, linetype=1)+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
#geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
#geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
ggplot(data=df, aes(x=year_mon,y=value, group=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red', 'green'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
#geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
#geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
ggplot(data=df, aes(x=year_mon,y=value, group=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
#geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
#geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
ggplot(data=df, aes(x=year_mon,y=value, group=variable,color=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
#geom_line(aes( y=CC_Theft),color="darkblue", linewidth=1, alpha=0.9, linetype=1)+
#geom_line(aes( y=Rhodium_Price),color="red", linewidth=1, alpha=0.9, linetype=1)+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rolling 12 Month Average")
ggplot(data=df, aes(x=year_mon,y=value, group=variable,color=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Normalized Trend")
ggplot(data=df, aes(x=year_mon,y=value, group=variable,color=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(fill = "grey", colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
ggplot(data=df, aes(x=year_mon,y=value, group=variable,color=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
ggplot(data=df, aes(x=year_mon,y=value, group=variable,color=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
#theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
#Filter
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
#Aggregate/Reduce
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
df<-melt( df
,measure.vars=c("Rhodium_Price","CC_Theft")
,id.vars= c("year_mon")
,varnames=c('Legend'))
ggplot(data=df, aes(x=year_mon,y=value, group=variable,color=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
View(df)
View(df)
View(df)
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
#Filter
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
#Aggregate/Reduce
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
df<-melt( df
,measure.vars=c("Rhodium_Price","CC_Theft")
,id.vars= c("year_mon")
,variable.name=c('Legend'))
ggplot(data=df, aes(x=year_mon,y=value, group=variable,color=variable))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
#Filter
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
#Aggregate/Reduce
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
df<-melt( df
,measure.vars=c("Rhodium_Price","CC_Theft")
,id.vars= c("year_mon")
,variable.name='Legend')
View(df)
ggplot(data=df, aes(x=year_mon,y=value, group=Legend,color=Legend))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
ggplot(Rhodium_Price_Data)
ggplot(Rhodium_Price_Data)+geom_line()
plot(Rhodium_Price_Data)
ggplot(data=df, aes(x=year_mon,y=Rhodium_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
ggplot(data=Rhodium_Price_Data, aes(x=year_mon,y=Rhodium_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
ggplot(data=Rhodium_Price_Data.[year_mon>'2019-12-01'], aes(x=year_mon,y=Rhodium_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
ggplot(data=Rhodium_Price_Data[year_mon>'2019-12-01'], aes(x=year_mon,y=Rhodium_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
ggplot( data=Rhodium_Price_Data[year_mon>'2019-12-01']
, aes(x=year_mon,y=Rhodium_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Rhodium Price Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rhodium Price")
#Rhodium
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
ggplot( data=Rhodium_Price_Data[year_mon>'2019-12-01']
, aes(x=year_mon,y=Rhodium_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Rhodium Price Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rhodium Price")
#Catalytic Theft
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
ggplot( data=data
, aes(x=year_mon,y=CC_Theft_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('red'))+
ggtitle(glue('Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Theft")
#Compare
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
df<-melt( df
,measure.vars=c("Rhodium_Price","CC_Theft")
,id.vars= c("year_mon")
,variable.name='Legend')
ggplot(data=df, aes(x=year_mon,y=value, group=Legend,color=Legend))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
View(all_desc)
#Rhodium
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
ggplot( data=Rhodium_Price_Data[year_mon>'2019-12-01']
, aes(x=year_mon,y=Rhodium_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue'))+
ggtitle(glue('Rhodium Price Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rhodium Price")
#Catalytic Theft
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
ggplot( data=data
, aes(x=year_mon,y=CC_Theft_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('red'))+
ggtitle(glue('Theft of motor vehicle parts or accessory Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Theft of motor vehicle parts or accessory")
#Compare
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
df<-melt( df
,measure.vars=c("Rhodium_Price","CC_Theft")
,id.vars= c("year_mon")
,variable.name='Legend')
ggplot(data=df, aes(x=year_mon,y=value, group=Legend,color=Legend))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
#Rhodium
Rhodium_Price_Data_wide<-fread( glue("{support_dir}Rhodium_Price_Data.csv")
,header=TRUE)
Rhodium_Price_Data<-melt( Rhodium_Price_Data_wide
,measure.vars=c("2019","2020","2021","2022","2023")
,id.vars= c("Month"))
Rhodium_Price_Data$year_mon<-as.POSIXct(paste0( Rhodium_Price_Data$variable,"-"
,Rhodium_Price_Data$Month,"-"
,1),tz = "UTC")
Rhodium_Price_Data$Rhodium_12_Month<-frollapply(Rhodium_Price_Data$value,12,mean)
ggplot( data=Rhodium_Price_Data[year_mon>'2019-12-01']
, aes(x=year_mon,y=Rhodium_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue'))+
ggtitle(glue('Rhodium Price Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Rhodium Price")
#Catalytic Theft
crimes_filtered<-multi_year[NIBRSDescription=='Theft of motor vehicle parts or accessory']
data<-crimes_filtered[,.(OffenseCount=sum(OffenseCount)),by=(year_mon)]%>%
.[,CC_Theft_12_Month:=frollapply(OffenseCount,12,mean),]%>%
.[order(year_mon)]%>%
.[year_mon>'2019-12-01']
ggplot( data=data
, aes(x=year_mon,y=CC_Theft_12_Month))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('red'))+
ggtitle(glue('Theft of motor vehicle parts or accessory Incident Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Theft of motor vehicle parts or accessory")
#Compare
df<-Rhodium_Price_Data[data,on=c('year_mon')]%>%
.[,c('year_mon','Rhodium_12_Month','CC_Theft_12_Month')]
df$Rhodium_Price <-(df$Rhodium_12_Month - mean(df$Rhodium_12_Month)) / sd(df$Rhodium_12_Month)
df$CC_Theft<-(df$CC_Theft_12_Month - mean(df$CC_Theft_12_Month)) / sd(df$CC_Theft_12_Month)
df<-melt( df
,measure.vars=c("Rhodium_Price","CC_Theft")
,id.vars= c("year_mon")
,variable.name='Legend')
ggplot(data=df, aes(x=year_mon,y=value, group=Legend,color=Legend))+
geom_line(linewidth=1, alpha=0.9, linetype=1)+
scale_color_manual(values=c('darkblue', 'red'))+
ggtitle(glue('Correlation of Rhodium Price Trends to Catalytic Converter Theft Trends'))+
theme_economist()+
theme(legend.key = element_rect(colour = "black"))+
theme(plot.title = element_text(hjust = 0.0))+
ylab("Scaled Trend")
